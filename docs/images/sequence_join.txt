title Joining a document

participant Client
participant Client\nThread
participant Server
participant Document

Client->>Server: Connect
Server->Server: accept()
Server-->*+Client\nThread: <<new>>

Client->>Client\nThread: REQ_JOIN("xfile")
Client\nThread->>Server: addToQueue(REQ_JOIN)
Server-->Client\nThread: <<return>>
Client\nThread-->>Client: RES_OK
Server->Server: processQueue()
alt document doesn't exist
    Server-->*+Document: <<new>>
else document exists
    Server->Document: getDocument("xfile")
end
Document-->Server: document

Client->>Client\nThread: REQ_TEXT
Client\nThread->>Server: addToQueue(REQ_TEXT)
Server-->Client\nThread: <<return>>
Server->Server: processQueue()
Server->Document: getText()
Document-->Server: text
Server-->>Client\nThread: addToQueue(RES_TEXT)
Client\nThread-->>Client: RES_TEXT


